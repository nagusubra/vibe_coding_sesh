<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Security-Policy" content="script-src 'self'; object-src 'none'; connect-src https://api.perplexity.ai;">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Content Value AI Rater</title>
  <link rel="stylesheet" href="popup.css" />
</head>
<body>
  <div class="container">
    <header class="header">
  <div class="title">Brainrot Radar</div>
      <button id="resetKey" class="link">Change API Key</button>
    </header>

    <section id="setup" class="card" style="display:none;">
      <div class="h">First-time setup</div>
      <label for="apiKey" class="muted">Perplexity API Key</label>
      <input id="apiKey" type="password" placeholder="pplx-..." />
      <button id="saveKey" class="btn">Save & Analyze</button>
      <div id="keyHelp" class="help muted">Your key is stored locally via chrome.storage.</div>
      <div id="keyStatus" class="status muted"></div>
    </section>

    <section id="verdictCard" class="card" style="display:none;">
      <div class="h">AI Verdict</div>
  <div id="bigEmoji" class="bigEmoji" aria-hidden="true" style="display:none;">🔎</div>
      <div id="status" class="status">Analyzing…</div>
      <div id="verdict" class="verdict"></div>
  <div id="timeSpent" class="muted" style="font-size:11px;margin-top:4px;">Time on this page: --:--</div>
      <pre id="reason" class="reason"></pre>
      <div class="spectrum" id="spectrum" aria-hidden="true">
        <div class="pointer" id="spectrumPointer" aria-label="Verdict spectrum pointer"></div>
      </div>
      <div class="spectrumStages" id="spectrumStages">
        <span data-pos="0.05">� brainrot</span>
        <span data-pos="0.18">📉 doomscroll</span>
        <span data-pos="0.32">😐 meh</span>
        <span data-pos="0.50">🫥 mid</span>
        <span data-pos="0.66">👌 decent</span>
        <span data-pos="0.82">💡 useful</span>
        <span data-pos="0.95">🚀 peak</span>
      </div>
      <div id="verdictGif" class="verdictGif" style="display:none;">
        <img id="gifImage" src="" alt="Verdict GIF" style="width:100%;height:80px;object-fit:cover;border-radius:8px;">
      </div>
      <div id="learningPrompt" class="learningPrompt" style="display:none;">
        <div class="h" style="font-size:12px;margin-bottom:6px;">🧠 Level up your brain instead!</div>
        <div id="learningLinks" class="learningLinks"></div>
      </div>
    </section>

    <section id="linksCard" class="card" style="display:none;">
      <div class="h" style="display:flex;justify-content:space-between;align-items:center;gap:8px;">
        <span>Top Links Scan</span>
        <button id="analyzeLinks" class="btn small">Analyze Links</button>
      </div>
      <div id="linksStatus" class="status muted">Idle</div>
      <div id="linksResults" class="links"></div>
    </section>

    <footer class="footer muted">
  Brainrot Radar v1.0 • Perplexity Sonar
      <div style="margin-top:6px;">
        <button id="statsBtn" class="link smallLink" type="button">stats for nerds</button>
      </div>
    </footer>
    <section id="statsPanel" class="card statsPanel" style="display:none;max-height:200px;overflow:auto;">
      <div class="h" style="display:flex;justify-content:space-between;align-items:center;gap:4px;">
        <span>Debug Data</span>
        <div style="display:flex;gap:6px;align-items:center;">
          <button id="maxStats" class="link" type="button" title="Expand">maximize</button>
          <button id="closeStats" class="link" type="button">close</button>
        </div>
      </div>
      <div class="muted" style="font-size:11px;margin-bottom:6px;">Raw payload & model reply (truncated). No API key shown.</div>
      <pre id="statsContent" style="white-space:pre-wrap;font-size:11px;line-height:1.3;background:#0f1736;border:1px dashed #2a3b78;padding:8px;border-radius:8px;max-height:120px;overflow:auto;"></pre>
    </section>
  </div>
  <script src="popup.js"></script>
</body>
</html>
